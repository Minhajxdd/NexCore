<%- include('../../partials/admin/head'); -%>

<title>Coupon Dashboard</title>


<%- include('../../partials/admin/nav'); -%>

    <!-- partial -->
    <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-12 grid-margin stretch-card">
              <div class="card corona-gradient-card">
                <div class="card-body py-0 px-0 px-sm-3 title-div">
                  <div class="row align-items-center ">
                    <div class="col-4 col-sm-3 col-xl-2">
                      <img src="/admin_template/assets/images/dashboard/Group126@2x1.png" class="gradient-corona-img img-fluid" alt="">
                    </div>
                    <div class="col-5 col-sm-7 col-xl-8 p-0 title">
                      <h2 class="mb-1 mb-sm-0">Coupons Dashboard</h2>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>






          <div class="col-lg-12 grid-margin stretch-card">
            <div class="card">
              <div class="card-body">
                <button id="create-new-coupon-btn" type="button" class="btn btn-success btn-rounded btn-fw mb-4">Create New +</button>
                <div class="table-responsive">
                  <table class="table table-dark">
                    <thead>
                      <tr>
                        <th> NO: </th>
                        <th> Coupon Code </th>
                        <th> Discount Price </th>
                        <th> Minimum Price </th>
                        <th> Expiration Date </th>
                        <th> Limit </th>
                        <th> Action </th>
                      </tr>
                    </thead>
                    <tbody id="table-body">


                    <% coupons.forEach((val , ind) => { %>
                      
                      <tr>
                        <td> <%= ind + 1 %> </td>
                        <td id="couponCode-body"> <%= val.couponCode %> </td>
                        <td id="discount-body"> <%= val.discountPrice %> </td>
                        <td id="minimum-body"> <%= val.minimumPrice %> </td>
                        <td id="date-body" value="<%= val.expirationDate %>"> <%= new Date(val.expirationDate).toLocaleString('en-IN', { dateStyle: 'medium', timeStyle: 'short' }) %> </td>
                        <td id="date-limit"> <%= val.limit %> </td>
                        <td>
                          <% if(!val.isDeleted){ %>
                            <button style="background-color: red;" data-id="<%= val._id %>" type="button"  id="delete-btn" class="btn btn-danger btn-md">Delete</button>
                          <% }else{ %>
                            <button style="background-color: #90EE90;" data-id="<%= val._id %>" type="button"  id="delete-btn" class="btn btn-danger btn-md">Enable</button>
                          <% } %>
                          <button data-id="<%= val._id %>" type="button" id="edit-btn" class="btn btn-primary btn-md edit-btn">Edit</button>
                        </td>
                      </tr>

                    <% }) %>  

                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>







<!-- coupon add form -->
<div class="card" id="add-coupon-div">
  <div class="card-body">
    <h4 class="card-title">Add a new Coupon</h4>
    <form class="forms-sample" id="add-coupon-form">


      <div class="form-group">
        <label for="add-coupon-code">Coupon Code</label>
        <input type="text" class="form-control" id="add-coupon-code"  name="cpCode" placeholder="coupon code..">
      </div>


      <div class="form-group">
        <label for="add-discount-price">Discount Price</label>
        <input type="number" class="form-control" id="add-discount-price" name="dscPrice" placeholder="discount price..">
      </div>

      <div class="form-group">
        <label for="add-minimum-value">Minimum Value</label>
        <input type="number" class="form-control" id="add-minimum-value" name="minPrice" placeholder="minimum value..">
      </div>


      <div class="form-group">
        <label for="add-expiration-date">Expiration Date</label>
        <input type="date" class="form-control" id="add-expiration-date" name="expDate" placeholder="coupon expiration date">
      </div>

      <div class="form-group">
        <label for="add-limit">Limit</label>
        <input type="number" class="form-control" id="add-limit" name="limit" placeholder="Limit">
      </div>
      
      <div class="form-group">
        <p style="color: red;" id="create-form-err-message"></p>
      </div>

      <button type="submit" id="add-coupon-submit" class="btn btn-primary mr-2">Submit</button>
      <button type="button" id="add-coupon-cancel" class="btn btn-dark">Cancel</button>
    </form>
  </div>
</div>
<!-- coupon add form -->    
 





<!-- coupon edit form -->
<div class="card" id="edit-coupon-div">
  <div class="card-body">
    <h4 class="card-title">Edit Coupon</h4>
    <form class="forms-sample" id="edit-coupon-form">

      <input type="hidden" id="edit-coupon-id" name="couponId"> 
      <div class="form-group">
        <label for="edit-coupon-code">Coupon Code</label>
        <input type="text" class="form-control" id="edit-coupon-code"  name="cpCode" placeholder="coupon code..">
      </div>


      <div class="form-group">
        <label for="edit-discount-price">Discount Price</label>
        <input type="number" class="form-control" id="edit-discount-price" name="dscPrice" placeholder="discount price..">
      </div>

      <div class="form-group">
        <label for="edit-minimum-value">Minimum Value</label>
        <input type="number" class="form-control" id="edit-minimum-value" name="minPrice" placeholder="minimum value..">
      </div>


      <div class="form-group">
        <label for="edit-expiration-date">Expiration Date</label>
        <input type="date" class="form-control" id="edit-expiration-date" name="expDate" placeholder="coupon expiration date">
      </div>

      <div class="form-group">
        <label for="edit-limit">Limit</label>
        <input type="number" class="form-control" id="edit-limit" name="limit" placeholder="Limit">
      </div>
      
      <div class="form-group">
        <p style="color: red;" id="edit-form-err-message"></p>
      </div>

      <button type="submit" id="edit-coupon-submit" class="btn btn-primary mr-2">Submit</button>
      <button type="button" id="edit-coupon-cancel" class="btn btn-dark">Cancel</button>
    </form>
  </div>
</div>
<!-- coupon edit form -->    



    </div>

</div> 


<style>
  #add-coupon-div,
  #edit-coupon-div{
    position: fixed;
    top: 0;
    width: 81%;
    margin-top: 90px;
    display: none;
  }
</style>

<!-- Custome js -->
 <script src="/script/admin/coupon.js"></script>


<!-- Cdn -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.7/axios.min.js"></script>


<%- include('../../partials/admin/body'); -%>

